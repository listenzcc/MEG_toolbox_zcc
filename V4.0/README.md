# Analysis RSVP data of MEG and EEG signal

- [Analysis RSVP data of MEG and EEG signal](#analysis-rsvp-data-of-meg-and-eeg-signal)
  - [Structure](#structure)
  - [Settings](#settings)
  - [Epochs Generation](#epochs-generation)
    - [Raw File Detection](#raw-file-detection)
    - [Epochs Generation](#epochs-generation-1)
  - [Visualization](#visualization)

## Structure

I would like to organize the scripts in a flatten manner.
Which means the scripts and other files (like files of .json, .ini, ...) will **almost** all listed on the top-level folder.
To make them understandable, a file table is used.

Table 1 File Table

| File name                                  | Function                                   | Description    | Section                                 |
| ------------------------------------------ | ------------------------------------------ | -------------- | --------------------------------------- |
| [auto_settings.py](./auto_settings.py)     | Generate settings of MEG and EEG data      | Python Script  | [Settings](#settings)                   |
| [auto-settings.ini](./auto-settings.ini)   | Settings of MEG and EEG data               | Auto Generated | [Settings](#settings)                   |
| [inventory.py](./inventory.py)             | Detect raw .fif files of MEG and EEG data  | Python Script  | [Epochs Generation](#epochs-generation) |
| [inventory.json](./inventory.json)         | Inventory of raw files, in .json format    | Auto Generated | [Epochs Generation](#epochs-generation) |
| [compute_epochs.py](./compute_epochs.py)   | Generate epochs based on the inventory     | Python Script  | [Epochs Generation](#epochs-generation) |
| [inventory-epo.json](./inventory-epo.json) | Inventory of epochs files, in .json format | Auto Generated | [Epochs Generation](#epochs-Generation) |

## Settings

The settings are stored in the file of [auto-settings.ini](./auto-settings.ini).
It is generated by the python script of [auto_settings.py](./auto_settings.py).

Example usage in shell:

```sh
# Make sure auto-settings.ini does not exist
python auto_settings.py
```

The generated ini file contains

- The path of processed and epochs files, in section of 'path'
- The parameters of generating MEG and EEG epochs, in section of 'epochs'

---

## Epochs Generation

I assume the raw MEG and EEG data has been preprocessed.
The thing is read the raw files and generate epochs.

### Raw File Detection

The raw MEG and EEG files were in the folder of 'preprocessed' option in the setting.
The python script of [inventory.py](./inventory.py) is to detect the raw .fif file.

Example usages in shell:

```sh
# Make sure inventory.json does not exist
python inventory.py
```

The file of [inventory.json](./inventory.json) will be generated accordingly.
There are two columns in the DataFrame

- rawPath: full path of raw .fif file
- subject: subject name, like 'MEG_S02' or 'EEG_S02'.

### Epochs Generation

The epochs will be generated based on the inventory of each raw files.
The python script of [compute_epochs.py](./compute_epochs.py) is to perform the generation.
It will read [inventory.json](./inventory.json) for raw files and generate epochs accordingly,
during the epochs generation, the parameters in settings are used.

Eventually, it will generate [inventory-epo.json](./inventory-epo.json),
by adding columns of

- epochsPath: full path of epochs file

Note before run: **Make sure everything is OK before start it, since the generation process costs much CPU resource.**

Example usages in shell:

```sh
# Make sure everything is OK before start it, since the generation process costs much CPU resource
# Make sure inventory-epo.json does not exist
python compute_epochs.py
```

---

## Visualization

The first phase of analysis is to visualize the **epochs** and **evoked** responses.

---
